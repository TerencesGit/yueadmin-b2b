webpackJsonp([46],{725:function(e,t,a){a(932);var r=a(10)(a(809),a(979),"data-v-0abe440a",null);e.exports=r.exports},809:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(337),i=function(e){return e&&e.__esModule?e:{default:e}}(r),o=a(70);t.default={data:function(){return{changeForm:{auditInformation:""},changeOrderContent:"",submitCommodity:{},currentCommodity:{},fullcalendarLoading:!1,serviceLoading:!1,activitieLoading:!1,servicePageInfo:{currPage:1,pageSize:10,count:0},activitiePageInfo:{currPage:1,pageSize:10,count:0},serviceParam:{wareId:"",skuDate:"",currPage:1,pageSize:10},activitieParam:{wareId:"",skuDate:"",currPage:1,pageSize:10},totalNum:2,totalPrice:0,orderInfo:{wareId:"",orderId:"",date:"",wareName:"",adultPrice:0,adultNum:0,childPrice:0,childNum:0},additionalServicesCheckList:[],recommendedActivitiesCheckList:[],skuList:[],additionalServicesList:[],recommendedActivitiesList:[],changeRules:{auditInformation:[{required:!0,message:"请输入审核信息",trigger:"blur"}]}}},methods:{dayClick:function(e,t){this.currentCommodity=(0,i.default)({},t),this.orderInfo.date=e,this.orderInfo.adultPrice=t.adultPrice,this.orderInfo.childPrice=t.childPrice,this.serviceParam.skuDate=t.start,this.activitieParam.skuDate=t.start,this.getTotalPrice(),this.getReadWareServerList(),this.getReadWareActivityList()},getReadWareServerList:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1],{wareId:this.serviceParam.wareId,skuDate:this.serviceParam.skuDate,currPage:this.serviceParam.currPage,pageSize:this.serviceParam.pageSize});this.serviceLoading=!0,(0,o.readWareServerList)(t).then(function(t){"0001"===t.data.code?(e.servicePageInfo.currPage=t.data.result.pageInfo.currPage,e.servicePageInfo.pageSize=t.data.result.pageInfo.pageSize,e.servicePageInfo.count=t.data.result.pageInfo.count,t.data.result.wareServerList.forEach(function(e,t){e.adultCount=0}),e.additionalServicesList=t.data.result.wareServerList):e.$message({message:t.data.message,type:"warning"}),e.serviceLoading=!1}).catch(function(t){console.log(t),e.catchError(t.response),e.serviceLoading=!1})},getReadWareActivityList:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1],{wareId:this.activitieParam.wareId,skuDate:this.activitieParam.skuDate,currPage:this.activitieParam.currPage,pageSize:this.activitieParam.pageSize});this.activitieLoading=!0,(0,o.readWareActiveList)(t).then(function(t){"0001"===t.data.code?(e.activitiePageInfo.count=t.data.result.pageInfo.count,t.data.result.wareActivityInfo.forEach(function(e,t){e.adultCount=0}),e.recommendedActivitiesList=t.data.result.wareActivityInfo):e.$message({message:t.data.message,type:"warning"}),e.activitieLoading=!1}).catch(function(t){console.log(t),e.catchError(t.response),e.activitieLoading=!1})},changeMonth:function(){},getTotalPrice:function(){var e=0,t=0;this.additionalServicesCheckList.forEach(function(t,a){e+=parseInt(t.adultPrice)*parseInt(t.adultCount)}),this.recommendedActivitiesCheckList.forEach(function(e,a){t+=parseInt(e.adultPrice)*parseInt(e.adultCount)}),this.totalPrice=e+t+parseInt(this.orderInfo.adultPrice)*parseInt(this.orderInfo.adultNum)+parseInt(this.orderInfo.childPrice)*parseInt(this.orderInfo.childNum)},additionalServices:function(e){console.log(e),this.additionalServicesCheckList=e,this.getTotalPrice()},recommendedActivities:function(e){console.log(e),this.recommendedActivitiesCheckList=e,this.getTotalPrice()},handleAdd:function(e,t){var a=this;t.adultCount<t.storageNum&&t.adultCount++,this.additionalServicesCheckList.forEach(function(e,r){t.wareCode===e.wareCode&&a.getTotalPrice()})},handleReduce:function(e,t){var a=this;t.adultCount>0&&t.adultCount--,this.additionalServicesCheckList.forEach(function(e,r){t.wareCode===e.wareCode&&a.getTotalPrice()})},handleRecommendAdd:function(e,t){var a=this;t.adultCount<t.storageNum&&t.adultCount++,this.recommendedActivitiesCheckList.forEach(function(e,r){t.wareCode===e.wareCode&&a.getTotalPrice()})},handleRecommendReduce:function(e,t){var a=this;t.adultCount>0&&t.adultCount--,this.recommendedActivitiesCheckList.forEach(function(e,r){t.wareCode===e.wareCode&&a.getTotalPrice()})},handleSizeChange:function(e){this.serviceParam.pageSize=e,this.getReadWareServerList()},handleCurrentChange:function(e){this.serviceParam.currPage=e,this.getReadWareServerList()},handleSizeChange1:function(e){this.activitieParam.pageSize=e,this.getReadWareActivityList()},handleCurrentChange1:function(e){this.activitieParam.currPage=e,this.getReadWareActivityList()},getfindWareInfo:function(e){var t=this,a={wareId:116};this.fullcalendarLoading=!0,(0,o.findWareInfo)(a).then(function(e){"0001"===e.data.code?(console.log(e),t.submitCommodity=(0,i.default)({},e.data.result.wareInfo),t.skuList=e.data.result.wareInfo.skuList,t.$message({message:e.data.message,type:"success"})):t.$message({message:e.data.message,type:"warning"}),t.fullcalendarLoading=!1}).catch(function(e){console.log(e),t.catchError(e.response),t.fullcalendarLoading=!1})},getOrderDetail:function(e){var t=this,a={orderId:e};(0,o.getOrderDetail)(a).then(function(e){"0001"===e.data.code?(t.changeOrderContent=e.data.result.info.cancelReason,e.data.result.item.forEach(function(e){2===e.wareType&&(t.orderInfo.adultNum=e.adultCount,t.orderInfo.childNum=e.childCount,t.orderInfo.singleNumber=e.singleNumber,t.orderInfo.wareName=e.wareName)})):t.$message({message:e.data.message,type:"warning"})}).catch(function(e){console.log(e),t.catchError(e.response)})},changeDetail:function(e){var t=this;this.orderInfo.date?this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var a={verifyInfo:"aaaa",oldOrderId:706,order:{statusInvoice:0,orderItem:[{wareId:28,skuId:315,dateDepart:"2017-07-10",strategyId:0,wareType:2,adultCount:2,childCount:1},{wareId:39,skuId:320,wareType:1,adultCount:2,childCount:0},{wareId:35,skuId:322,wareType:1,adultCount:2,childCount:0}]}};(0,o.checkChange)(a).then(function(e){console.log(e),"0001"===e.data.code?(t.$message({message:e.data.message,type:"success"}),t.$router.back()):t.$message({message:e.data.message,type:"warning"})}).catch(function(e){console.log(e),t.catchError(e.response)})}):this.$message({message:"请选择主商品",type:"warning"})},approveDetail:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var a={verifyInfo:"aaaa",oldOrderId:706};console.log(a),(0,o.checkNoPass)(a).then(function(e){console.log(e),"0001"===e.data.code?(t.$message({message:e.data.message,type:"success"}),t.$router.back()):t.$message({message:e.data.message,type:"warning"})}).catch(function(e){console.log(e),t.catchError(e.response)})})}},created:function(){this.orderInfo.wareId=this.$route.query.wareId,this.orderInfo.orderId=this.$route.query.orderId,this.getOrderDetail(this.$route.query.orderId),this.getfindWareInfo(this.$route.query.wareId),this.serviceParam.wareId=this.$route.query.wareId,this.activitieParam.wareId=this.$route.query.wareId}}},887:function(e,t,a){t=e.exports=a(722)(),t.push([e.i,".totalPrice[data-v-0abe440a]{font-size:30px;color:#ff6f00}","",{version:3,sources:["D:/B2B-YueProject/yueadmin-b2b/src/pages/admin/order/changeOperation.vue"],names:[],mappings:"AACA,6BACC,eAAgB,AAChB,aAAc,CACd",file:"changeOperation.vue",sourcesContent:["\n.totalPrice[data-v-0abe440a]{\n\tfont-size: 30px;\n\tcolor:#ff6f00;\n}\n"],sourceRoot:""}])},932:function(e,t,a){var r=a(887);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(723)("6706175c",r,!0)},979:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"changeOperation"},[a("el-card",{staticClass:"box-card",staticStyle:{padding:"0 20px"}},[a("div",{staticClass:"clearfix",slot:"header"},[a("h2",{staticStyle:{color:"#20a0ff"},domProps:{textContent:e._s(e.orderInfo.wareName)}})]),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",[a("h2",[e._v("改单申请内容：")]),e._v(" "),a("div",{staticStyle:{border:"1px solid #bfcbd9","border-radius":"5px","min-height":"100px",padding:"20px"},domProps:{textContent:e._s(e.changeOrderContent)}})])],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"star"}},[a("el-col",{attrs:{span:16}},[a("fullcalendar",{directives:[{name:"loading",rawName:"v-loading",value:e.fullcalendarLoading,expression:"fullcalendarLoading"}],staticStyle:{padding:"20px 20px 20px 0"},attrs:{events:e.skuList,"first-day":"0"},on:{changeMonth:e.changeMonth,eventClick:e.dayClick}})],1),e._v(" "),a("el-col",{staticStyle:{"margin-top":"66px"},attrs:{span:8}},[a("el-form",{ref:"orderInfo",attrs:{model:e.orderInfo,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"发团日期："}},[a("el-date-picker",{attrs:{readonly:"",type:"date",placeholder:"发团日期"},model:{value:e.orderInfo.date,callback:function(t){e.orderInfo.date=t},expression:"orderInfo.date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"成人数量："}},[a("el-input-number",{attrs:{disabled:!0},model:{value:e.orderInfo.adultNum,callback:function(t){e.orderInfo.adultNum=t},expression:"orderInfo.adultNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"儿童数量："}},[a("el-input-number",{attrs:{disabled:!0},model:{value:e.orderInfo.childNum,callback:function(t){e.orderInfo.childNum=t},expression:"orderInfo.childNum"}})],1)],1)],1)],1),e._v(" "),a("h2",[e._v("附加服务")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.serviceLoading,expression:"serviceLoading"}],ref:"additionalServicesList",staticStyle:{width:"100%"},attrs:{data:e.additionalServicesList,border:"","tooltip-effect":"dark"},on:{"selection-change":e.additionalServices}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"wareCode",label:"商品编码",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"wareName",label:"商品名称",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"openDate",label:"起售时间",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"closeDate",label:"停售时间",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"wareDesc",label:"产品描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"adultPrice",label:"价格",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"storageNum",label:"库存",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"adultCount",label:"数量",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.handleAdd(t.$index,t.row)}}},[e._v("+1")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){e.handleReduce(t.$index,t.row)}}},[e._v("-1")])]}}])})],1),e._v(" "),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"end"}},[a("el-pagination",{attrs:{"current-page":e.servicePageInfo.currPage,"page-sizes":[10,20,30,40],"page-size":e.servicePageInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.additionalServicesList.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("h2",[e._v("推荐活动")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.activitieLoading,expression:"activitieLoading"}],ref:"recommendedActivitiesList",staticStyle:{width:"100%"},attrs:{data:e.recommendedActivitiesList,border:"","tooltip-effect":"dark"},on:{"selection-change":e.recommendedActivities}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"wareCode",label:"商品编码",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"wareName",label:"商品名称",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"openDate",label:"起售时间",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"closeDate",label:"停售时间",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"wareDesc",label:"产品描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"adultPrice",label:"价格",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"storageNum",label:"库存",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"adultCount",label:"数量",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{width:"180",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.handleRecommendAdd(t.$index,t.row)}}},[e._v("+1")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){e.handleRecommendReduce(t.$index,t.row)}}},[e._v("-1")])]}}])})],1),e._v(" "),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"end"}},[a("el-pagination",{attrs:{"current-page":e.activitiePageInfo.currPage,"page-sizes":[10,20,30,40],"page-size":e.activitiePageInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.recommendedActivitiesList.length},on:{"size-change":e.handleSizeChange1,"current-change":e.handleCurrentChange1}})],1),e._v(" "),a("el-row",{staticStyle:{"margin-top":"50px"},attrs:{type:"flex",justify:"center"}},[a("el-col",[a("h2",[e._v("审核信息：")]),e._v(" "),a("el-form",{ref:"changeForm",attrs:{model:e.changeForm,rules:e.changeRules}},[a("el-form-item",{attrs:{prop:"auditInformation"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:"请输入审核信息"},model:{value:e.changeForm.auditInformation,callback:function(t){e.changeForm.auditInformation=t},expression:"changeForm.auditInformation"}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticStyle:{"margin-top":"50px"},attrs:{type:"flex",justify:"end"}},[a("div",{staticClass:"totalPrice"},[e._v("总价：￥"),a("span",{domProps:{textContent:e._s(e.totalPrice)}})])]),e._v(" "),a("el-row",{staticStyle:{"margin-top":"50px"},attrs:{type:"flex",justify:"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.changeDetail("changeForm")}}},[e._v("确认改单")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.approveDetail("changeForm")}}},[e._v("驳回改单")])],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=46.95b0b6e530a679d73e0c.js.map