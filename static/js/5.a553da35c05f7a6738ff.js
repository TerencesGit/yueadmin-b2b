webpackJsonp([5],{1279:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(339),n=r(l),i=a(866),s=r(i),o=a(52);t.default={data:function(){return{loading:!1,index:"",dialogAdd:!1,dialogEdit:!1,addList:!0,submit:{reserve2:"",deadlineDateType:"",list:[]},strategyType:[{label:"出行日",value:1},{label:"拍摄日",value:2},{label:"付款日",value:3},{label:"不退改",value:4}],addStrategyDialog:!1,addRules:{refundName:[{required:!0,message:"请输入规则名",trigger:"blur"}],compensationRate:[{required:!0,validator:function(e,t,a){t?"number"!=typeof t?a(new Error("请输入数字")):t<0||t>1?a(new Error("请输入0-1之间的数字")):a():a(new Error("请输入赔偿比例"))},trigger:"blur"}],refundDateName:[{required:!0,message:"请输入退改日命名",trigger:"blur"}],refundDays:[{required:!0,validator:function(e,t,a){t?"number"!=typeof t?a(new Error("请输入数字")):t&&!(0,s.default)(t)?a(new Error("请输入整数天数")):a():a(new Error("请输入退改日期"))},trigger:"blur"}],status:[{required:!0,type:"number",message:"请选择退改状态",trigger:"change"}],note:[{required:!0,message:"请输入备注/描述",trigger:"blur"}]},retreatStrategy:{refundName:"",compensationRate:"",refundDateName:"",refundDays:"",note:""},tempRetreatStrategy:{refundName:"",compensationRate:"",refundDateName:"",refundDays:"",note:""},retreatStrategys:[]}},methods:{add:function(){this.addStrategyDialog=!0},handleAdd:function(e,t){this.dialogAdd=!0,this.index=e},addRetreatStrategys:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a=(0,n.default)({},t.tempRetreatStrategy);t.retreatStrategys.splice(t.index+1,0,a),t.dialogAdd=!1;for(var r in t.tempRetreatStrategy)t.tempRetreatStrategy[r]=""})},handleEdit:function(e,t){this.dialogEdit=!0,this.retreatStrategy=(0,n.default)({},t),console.log(t),this.index=e},editRetreatStrategys:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.dialogEdit=!1;for(var a in t.retreatStrategys[t.index])t.retreatStrategys[t.index][a]=t.retreatStrategy[a]})},handleDelete:function(e,t){this.retreatStrategys.splice(e,1)},addStrategy:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.addStrategyDialog=!1,t.addList=!0,t.dialogAdd=!0,t.index=-1})},saveStrategy:function(){var e=this;if(this.retreatStrategys.forEach(function(t,a,r){if(a>0&&t.refundDays<=r[a-1].refundDays)return void e.$message({title:"警告",message:"第"+(a+1)+"条退改日期必须比第"+a+"条天数大",type:"warning"})}),this.retreatStrategys.every(function(e,t,a){return!(t>0)||e.refundDays>a[t-1].refundDays})&&this.retreatStrategys.length>0){this.loading=!0,this.retreatStrategys.forEach(function(e){for(var t in e)e[t]+=""});var t={reserve2:this.submit.reserve2,deadlineDateType:this.submit.deadlineDateType+"",list:this.retreatStrategys};console.log(t),(0,o.sysRefundInfoInsert)(t).then(function(t){"0001"===t.data.code&&(e.$message({title:"成功",message:"成功发送请求到后台",type:"success"}),e.loading=!1,e.$router.push({path:"/admin/system/retreatStrategy/retreatStrategyList"})),e.loading=!1}).catch(function(t){console.log(t),e.$catchError(err),e.loading=!1})}}},computed:{typeTxt:function(){for(var e=0;e<this.strategyType.length;e++)if(this.submit.deadlineDateType===this.strategyType[e].value)return this.strategyType[e].label}},mounted:function(){this.add()}}},1437:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"retreatStrategyAdd"},[a("el-dialog",{attrs:{top:"30%","close-on-click-modal":!1,size:"tiny",title:"触发退改协议类型",visible:e.addStrategyDialog},on:{"update:visible":function(t){e.addStrategyDialog=t}}},[a("el-form",{ref:"submit",attrs:{model:e.submit,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"请选择类型",prop:"deadlineDateType",rules:[{required:!0,message:"类型不能为空"}]}},[a("el-radio-group",{model:{value:e.submit.deadlineDateType,callback:function(t){e.submit.deadlineDateType=t},expression:"submit.deadlineDateType"}},e._l(e.strategyType,function(t,r){return a("el-radio",{key:r,attrs:{label:t.value}},[e._v(e._s(t.label))])}))],1),e._v(" "),a("el-form-item",{attrs:{label:"请输入策略名称",prop:"reserve2",rules:[{required:!0,message:"策略名称不能为空"}]}},[a("el-input",{attrs:{size:"small","auto-complete":"off"},model:{value:e.submit.reserve2,callback:function(t){e.submit.reserve2=t},expression:"submit.reserve2"}})],1)],1),e._v(" "),a("span",{slot:"footer"},[a("el-button",{on:{click:function(t){e.addStrategyDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addStrategy("submit")}}},[e._v("确 定")])],1)],1),e._v(" "),e.addList?a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("div",[e._v("策略名称："+e._s(e.submit.reserve2))]),e._v(" "),a("div",[e._v("触发退改协议类型："+e._s(e.typeTxt))])]):e._e(),e._v(" "),a("el-dialog",{attrs:{size:"tiny",title:"新增",visible:e.dialogAdd},on:{"update:visible":function(t){e.dialogAdd=t}}},[a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:20}},[a("el-form",{ref:"tempRetreatStrategy",attrs:{"label-width":"120px",rules:e.addRules,model:e.tempRetreatStrategy}},[a("el-form-item",{attrs:{label:"规则名：",prop:"refundName"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入规则名"},model:{value:e.tempRetreatStrategy.refundName,callback:function(t){e.tempRetreatStrategy.refundName=t},expression:"tempRetreatStrategy.refundName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"赔偿比例：",prop:"compensationRate"}},[a("el-input-number",{attrs:{placeholder:"请选择赔偿比例",size:"small",step:.01,min:0,max:1},model:{value:e.tempRetreatStrategy.compensationRate,callback:function(t){e.tempRetreatStrategy.compensationRate=e._n(t)},expression:"tempRetreatStrategy.compensationRate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"退改日命名：",prop:"refundDateName"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入退改日命名"},model:{value:e.tempRetreatStrategy.refundDateName,callback:function(t){e.tempRetreatStrategy.refundDateName=t},expression:"tempRetreatStrategy.refundDateName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"退改日期：",prop:"refundDays"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入整数天数"},model:{value:e.tempRetreatStrategy.refundDays,callback:function(t){e.tempRetreatStrategy.refundDays=e._n(t)},expression:"tempRetreatStrategy.refundDays"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注/描述：",prop:"note"}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},size:"small",placeholder:"请输入备注/描述",type:"textarea"},model:{value:e.tempRetreatStrategy.note,callback:function(t){e.tempRetreatStrategy.note=t},expression:"tempRetreatStrategy.note"}})],1)],1)],1)],1),e._v(" "),a("div",{slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogAdd=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addRetreatStrategys("tempRetreatStrategy")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{size:"tiny",title:"编辑",visible:e.dialogEdit},on:{"update:visible":function(t){e.dialogEdit=t}}},[a("el-form",{ref:"retreatStrategy",attrs:{"label-width":"120px",rules:e.addRules,model:e.retreatStrategy}},[a("el-form-item",{attrs:{label:"规则名：",prop:"refundName"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入规则名"},model:{value:e.retreatStrategy.refundName,callback:function(t){e.retreatStrategy.refundName=t},expression:"retreatStrategy.refundName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"赔偿比例：",prop:"compensationRate"}},[a("el-input-number",{attrs:{placeholder:"请选择赔偿比例",size:"small",step:.01,min:0,max:1},model:{value:e.retreatStrategy.compensationRate,callback:function(t){e.retreatStrategy.compensationRate=e._n(t)},expression:"retreatStrategy.compensationRate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"退改日命名：",prop:"refundDateName"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入退改日命名"},model:{value:e.retreatStrategy.refundDateName,callback:function(t){e.retreatStrategy.refundDateName=t},expression:"retreatStrategy.refundDateName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"退改日期：",prop:"refundDays"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入整数天数"},model:{value:e.retreatStrategy.refundDays,callback:function(t){e.retreatStrategy.refundDays=e._n(t)},expression:"retreatStrategy.refundDays"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注/描述：",prop:"note"}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},size:"small",placeholder:"请输入备注/描述",type:"textarea"},model:{value:e.retreatStrategy.note,callback:function(t){e.retreatStrategy.note=t},expression:"retreatStrategy.note"}})],1)],1),e._v(" "),a("div",{slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogEdit=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editRetreatStrategys("retreatStrategy")}}},[e._v("确 定")])],1)],1),e._v(" "),e.addList?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.retreatStrategys,border:""}},[a("el-table-column",{attrs:{label:"规则名",prop:"refundName"}}),e._v(" "),a("el-table-column",{attrs:{label:"赔偿比例",prop:"compensationRate"}}),e._v(" "),a("el-table-column",{attrs:{label:"退改日命名",prop:"refundDateName"}}),e._v(" "),a("el-table-column",{attrs:{label:"退改日期",prop:"refundDays"}}),e._v(" "),a("el-table-column",{attrs:{label:"备注/描述",prop:"note"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"230"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.handleAdd(t.$index,t.row)}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1):e._e(),e._v(" "),e.addList?a("el-row",{staticStyle:{"margin-top":"50px"},attrs:{type:"flex",justify:"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveStrategy}},[e._v("保存")])],1):e._e()],1)},staticRenderFns:[]}},760:function(e,t,a){var r=a(7)(a(1279),a(1437),null,null);e.exports=r.exports},866:function(e,t,a){e.exports={default:a(867),__esModule:!0}},867:function(e,t,a){a(869),e.exports=a(37).Number.isInteger},868:function(e,t,a){var r=a(72),l=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&l(e)===e}},869:function(e,t,a){var r=a(71);r(r.S,"Number",{isInteger:a(868)})}});
//# sourceMappingURL=5.a553da35c05f7a6738ff.js.map