{"version":3,"sources":["webpack:///static/js/51.990cb9b153a3cc1d12a0.js","webpack:///./src/pages/provider/ware/wareInput/multimedia.vue?128c","webpack:///./src/pages/provider/ware/wareInput/multimedia.vue","webpack:///multimedia.vue"],"names":["webpackJsonp","1007","module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","type","on","click","$event","uploadVisible","_v","disabled","sels","length","batchRemove","directives","name","rawName","value","expression","staticStyle","width","border","data","mediaList","highlight-current-row","selection-change","selsChange","label","scopedSlots","_u","key","fn","scope","src","row","filePath","height","viewImage","prop","formatter","formatCreateTime","sortable","on-color","off-color","on-text","off-text","on-value","off-value","isMainPic","change","handleStatus","model","callback","$$v","status","size","handleSetMainImg","handleSingleDelete","handleNext","title","visible","update:visible","class","text-danger","mediaLength","span","_s","maxLength","ref","uploadData","action","list-type","accept","on-preview","handleImgPreview","on-remove","handleRemove","before-upload","beforeUpload","on-success","handleSuccess","on-error","handleError","multiple","slot","onSubmit","previewVisible","previewImgUrl","staticRenderFns","791","__webpack_require__","Component","875","Object","defineProperty","_api","default","wareId","fileList","fileId","fileIdList","fileUrlType","loading","methods","formatIsMainPic","column","$moment","createTime","format","getWareFileList","_this","params","readWareFileList","then","res","console","log","code","result","$message","error","message","catch","catchError","response","file","isJPG","isLt2M","push","url","resFile","path","err","filter","_this2","mediaForm","createWareFile","success","$refs","uploadMedia","clearFiles","_this3","updatetWareFileState","_this4","_fileIdList","$confirm","deleteWareFile","_this5","fileIds","map","sel","forEach","_this6","$notify","updateWareFileIsMainPic","$router","computed","mounted","$store","dispatch","parseInt","$route","query"],"mappings":"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","file":"static/js/51.990cb9b153a3cc1d12a0.js","sourcesContent":["webpackJsonp([51],{\n\n/***/ 1007:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('section', [_c('el-row', {\n    staticClass: \"toolbar\"\n  }, [_c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.uploadVisible = true\n      }\n    }\n  }, [_vm._v(\"本地上传\")]), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"danger\",\n      \"disabled\": this.sels.length === 0\n    },\n    on: {\n      \"click\": _vm.batchRemove\n    }\n  }, [_vm._v(\"批量删除\")])], 1), _vm._v(\" \"), _c('el-table', {\n    directives: [{\n      name: \"loading\",\n      rawName: \"v-loading\",\n      value: (_vm.loading),\n      expression: \"loading\"\n    }],\n    staticStyle: {\n      \"width\": \"100%\"\n    },\n    attrs: {\n      \"border\": \"\",\n      \"data\": _vm.mediaList,\n      \"highlight-current-row\": \"\"\n    },\n    on: {\n      \"selection-change\": _vm.selsChange\n    }\n  }, [_c('el-table-column', {\n    attrs: {\n      \"type\": \"selection\",\n      \"width\": \"55\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"type\": \"index\",\n      \"width\": \"60\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"图片缩略图\",\n      \"width\": \"140\"\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(scope) {\n        return [_c('img', {\n          staticClass: \"cell-img\",\n          attrs: {\n            \"src\": scope.row.filePath,\n            \"height\": \"60px\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.viewImage(scope.row.filePath)\n            }\n          }\n        })]\n      }\n    }])\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"更新者\",\n      \"prop\": \"createName\",\n      \"width\": \"100\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"更新时间\",\n      \"prop\": \"createTime\",\n      \"formatter\": _vm.formatCreateTime,\n      \"sortable\": \"\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"是否显示\",\n      \"width\": \"120\"\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(scope) {\n        return [_c('el-switch', {\n          attrs: {\n            \"on-color\": \"#13ce66\",\n            \"off-color\": \"#ff4949\",\n            \"on-text\": \"是\",\n            \"off-text\": \"否\",\n            \"on-value\": 1,\n            \"off-value\": 0,\n            \"disabled\": scope.row.isMainPic === 1\n          },\n          on: {\n            \"change\": function($event) {\n              _vm.handleStatus(scope.row)\n            }\n          },\n          model: {\n            value: (scope.row.status),\n            callback: function($$v) {\n              scope.row.status = $$v\n            },\n            expression: \"scope.row.status\"\n          }\n        })]\n      }\n    }])\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"操作\",\n      \"width\": \"180\"\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(scope) {\n        return [(scope.row.isMainPic === 0) ? _c('div', [_c('el-button', {\n          attrs: {\n            \"size\": \"small\",\n            \"type\": \"primary\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.handleSetMainImg(scope.row)\n            }\n          }\n        }, [_vm._v(\"设为主图\")]), _vm._v(\" \"), _c('el-button', {\n          attrs: {\n            \"size\": \"small\",\n            \"type\": \"danger\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.handleSingleDelete(scope.row)\n            }\n          }\n        }, [_vm._v(\"删除\")])], 1) : _c('div', [_c('el-button', {\n          attrs: {\n            \"size\": \"small\",\n            \"type\": \"success\"\n          },\n          on: {\n            \"click\": function($event) {\n              return false\n            }\n          }\n        }, [_vm._v(\"当前主图\")])], 1)]\n      }\n    }])\n  })], 1), _vm._v(\" \"), _c('el-row', {\n    staticClass: \"text-center m-t\"\n  }, [_c('el-button', {\n    attrs: {\n      \"size\": \"large\",\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": _vm.handleNext\n    }\n  }, [_vm._v(\"下一步\")])], 1), _vm._v(\" \"), _c('el-dialog', {\n    attrs: {\n      \"title\": \"本地上传\",\n      \"visible\": _vm.uploadVisible,\n      \"size\": \"small\"\n    },\n    on: {\n      \"update:visible\": function($event) {\n        _vm.uploadVisible = $event\n      }\n    }\n  }, [_c('el-row', [_c('el-col', {\n    class: {\n      'text-danger': _vm.mediaLength === 0\n    },\n    attrs: {\n      \"span\": 20\n    }\n  }, [_vm._v(\"\\n\\t\\t\\t\\t\\t建议上传大小为1024*512图片，单张不超过2M，最多上传\" + _vm._s(_vm.maxLength) + \"张，还可以上传\" + _vm._s(_vm.mediaLength) + \"张。\\n\\t\\t\\t\\t\")])], 1), _vm._v(\" \"), _c('el-row', {\n    staticClass: \"m-t\"\n  }, [_c('el-col', {\n    attrs: {\n      \"span\": 20\n    }\n  }, [_c('el-upload', {\n    ref: \"uploadMedia\",\n    staticClass: \"multiple-uploader\",\n    attrs: {\n      \"name\": \"fileName\",\n      \"data\": _vm.uploadData,\n      \"action\": \"https://jsonplaceholder.typicode.com/posts/\",\n      \"list-type\": \"picture-card\",\n      \"accept\": \"image/jpeg, image/png\",\n      \"on-preview\": _vm.handleImgPreview,\n      \"on-remove\": _vm.handleRemove,\n      \"before-upload\": _vm.beforeUpload,\n      \"on-success\": _vm.handleSuccess,\n      \"on-error\": _vm.handleError,\n      \"multiple\": true,\n      \"disabled\": _vm.mediaLength === 0\n    }\n  }, [_c('i', {\n    staticClass: \"el-icon-plus\"\n  })])], 1)], 1), _vm._v(\" \"), _c('div', {\n    slot: \"footer\"\n  }, [_c('el-button', {\n    on: {\n      \"click\": function($event) {\n        _vm.uploadVisible = false\n      }\n    }\n  }, [_vm._v(\"取 消\")]), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": _vm.onSubmit\n    }\n  }, [_vm._v(\"确 定\")])], 1)], 1), _vm._v(\" \"), _c('el-dialog', {\n    attrs: {\n      \"size\": \"tiny\"\n    },\n    model: {\n      value: (_vm.previewVisible),\n      callback: function($$v) {\n        _vm.previewVisible = $$v\n      },\n      expression: \"previewVisible\"\n    }\n  }, [_c('img', {\n    attrs: {\n      \"width\": \"100%\",\n      \"src\": _vm.previewImgUrl\n    }\n  })])], 1)\n},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 791:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar Component = __webpack_require__(10)(\n  /* script */\n  __webpack_require__(875),\n  /* template */\n  __webpack_require__(1007),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 875:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _api = __webpack_require__(70);\n\nexports.default = {\n\tdata: function data() {\n\t\treturn {\n\t\t\twareId: '',\n\t\t\tmaxLength: 10,\n\t\t\tpreviewImgUrl: '',\n\t\t\tuploadVisible: false,\n\t\t\tpreviewVisible: false,\n\t\t\tfileList: [],\n\t\t\tmediaList: [{\n\t\t\t\tfileId: 100001,\n\t\t\t\tisMainPic: 1,\n\t\t\t\tstatus: 1\n\t\t\t}, {\n\t\t\t\tfileId: 100002,\n\t\t\t\tisMainPic: 0,\n\t\t\t\tstatus: 0\n\t\t\t}],\n\t\t\tfileIdList: [],\n\t\t\tsels: [],\n\t\t\tuploadData: {\n\t\t\t\tfileUrlType: 1\n\t\t\t},\n\t\t\tloading: false\n\t\t};\n\t},\n\n\tmethods: {\n\t\tformatIsMainPic: function formatIsMainPic(row, column) {\n\t\t\treturn row.isMainPic === 1 ? '是' : '否';\n\t\t},\n\t\tformatCreateTime: function formatCreateTime(row, column) {\n\t\t\treturn this.$moment(row.createTime).format('YYYY-MM-DD HH:mm:ss');\n\t\t},\n\t\tgetWareFileList: function getWareFileList() {\n\t\t\tvar _this = this;\n\n\t\t\tthis.loading = true;\n\t\t\tvar params = {\n\t\t\t\twareId: this.wareId\n\t\t\t};\n\t\t\t(0, _api.readWareFileList)(params).then(function (res) {\n\t\t\t\tconsole.log(res);\n\t\t\t\tif (res.data.code === '0001') {\n\t\t\t\t\t_this.mediaList = res.data.result.fileList;\n\t\t\t\t} else {\n\t\t\t\t\t_this.$message.error(res.data.message);\n\t\t\t\t}\n\t\t\t\t_this.loading = false;\n\t\t\t}).catch(function (error) {\n\t\t\t\t_this.loading = false;\n\t\t\t\t_this.catchError(error.response);\n\t\t\t});\n\t\t},\n\t\tbeforeUpload: function beforeUpload(file) {\n\t\t\tvar isJPG = file.type === 'image/jpeg' || file.type === 'image/png';\n\t\t\tvar isLt2M = file.size / 1024 / 1024 < 2;\n\t\t\tif (!isJPG) {\n\t\t\t\tthis.$message.error('图片只能是 JPG 或 PNG格式!');\n\t\t\t}\n\t\t\tif (!isLt2M) {\n\t\t\t\tthis.$message.error('图片大小不能超过 2MB!');\n\t\t\t}\n\t\t\treturn isJPG && isLt2M;\n\t\t},\n\t\thandleSuccess: function handleSuccess(res, file) {\n\t\t\tthis.fileList.push(file.url);\n\t\t\tif (res.code === '0001') {\n\t\t\t\tvar resFile = res.result.file;\n\t\t\t\tfile.path = resFile.filePath;\n\t\t\t\tthis.fileList.push(resFile);\n\t\t\t} else {\n\t\t\t\tthis.$message.error(res.message);\n\t\t\t}\n\t\t},\n\t\thandleError: function handleError(err, file) {\n\t\t\tconsole.log(file);\n\t\t\tthis.$message.error('图片上传失败，请重试');\n\t\t},\n\t\thandleRemove: function handleRemove(file) {\n\t\t\tif (!file) return;\n\t\t\tvar fileList = this.fileList;\n\t\t\tvar filePath = file.path || '';\n\t\t\tfileList = fileList.filter(function (file) {\n\t\t\t\treturn file.filePath !== filePath;\n\t\t\t});\n\t\t\tthis.fileList = fileList;\n\t\t},\n\t\thandleImgPreview: function handleImgPreview(file, fileList) {\n\t\t\tthis.previewImgUrl = file.url;\n\t\t\tthis.previewVisible = true;\n\t\t},\n\t\tonSubmit: function onSubmit() {\n\t\t\tvar _this2 = this;\n\n\t\t\tvar mediaForm = {\n\t\t\t\twareId: this.wareId,\n\t\t\t\tfileList: this.fileList\n\t\t\t};\n\t\t\tconsole.log(mediaForm);\n\t\t\t(0, _api.createWareFile)(mediaForm).then(function (res) {\n\t\t\t\tif (res.data.code === '0001') {\n\t\t\t\t\t_this2.$message.success('上传成功');\n\t\t\t\t\t_this2.getWareFileList();\n\t\t\t\t} else {\n\t\t\t\t\t_this2.$message.error(res.data.message);\n\t\t\t\t}\n\t\t\t\t_this2.uploadVisible = false;\n\t\t\t\t_this2.fileList = [];\n\t\t\t\t_this2.$refs.uploadMedia.clearFiles();\n\t\t\t}).catch(function (error) {\n\t\t\t\t_this2.catchError(error.response);\n\t\t\t\t_this2.uploadVisible = false;\n\t\t\t\t_this2.fileList = [];\n\t\t\t\t_this2.$refs.uploadMedia.clearFiles();\n\t\t\t});\n\t\t},\n\t\tselsChange: function selsChange(sels) {\n\t\t\tthis.sels = sels;\n\t\t},\n\t\tviewImage: function viewImage(filePath) {\n\t\t\tthis.previewImgUrl = filePath;\n\t\t\tthis.previewVisible = true;\n\t\t},\n\t\thandleStatus: function handleStatus(row) {\n\t\t\tvar _this3 = this;\n\n\t\t\tvar data = {\n\t\t\t\tfileId: row.fileId\n\t\t\t};\n\t\t\t(0, _api.updatetWareFileState)(data).then(function (res) {\n\t\t\t\tif (res.data.code === '0001') {\n\t\t\t\t\t_this3.$message.success(res.data.message);\n\t\t\t\t} else {\n\t\t\t\t\trow.status = row.status === 1 ? 0 : 1;\n\t\t\t\t\t_this3.$message.error(res.data.message);\n\t\t\t\t}\n\t\t\t}).catch(function (error) {\n\t\t\t\trow.status = row.status === 1 ? 0 : 1;\n\t\t\t\t_this3.catchError(error.response);\n\t\t\t});\n\t\t},\n\t\thandleSingleDelete: function handleSingleDelete(row) {\n\t\t\tvar _this4 = this;\n\n\t\t\tvar _fileIdList = [];\n\t\t\t_fileIdList[0] = { fileId: row.fileId };\n\t\t\tthis.$confirm('确认删除该图片？', '提示', { type: 'warning' }).then(function () {\n\t\t\t\tvar data = {\n\t\t\t\t\tfileIdList: _fileIdList\n\t\t\t\t};\n\t\t\t\t(0, _api.deleteWareFile)(data).then(function (res) {\n\t\t\t\t\tif (res.data.code === '0001') {\n\t\t\t\t\t\t_this4.$message.success(res.data.message);\n\t\t\t\t\t\t_this4.getWareFileList();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_this4.$message.error(res.data.message);\n\t\t\t\t\t}\n\t\t\t\t}).catch(function (error) {\n\t\t\t\t\t_this4.catchError(error.response);\n\t\t\t\t});\n\t\t\t}).catch(function (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t\t_this4.$message('已取消操作');\n\t\t\t});\n\t\t},\n\t\tbatchRemove: function batchRemove() {\n\t\t\tvar _this5 = this;\n\n\t\t\tthis.$confirm('确认删除选中的图片吗？', '提示', { type: 'warning' }).then(function () {\n\t\t\t\tvar fileIds = _this5.sels.map(function (sel) {\n\t\t\t\t\treturn sel.fileId;\n\t\t\t\t});\n\t\t\t\tvar _fileIdList = [];\n\t\t\t\tfileIds.forEach(function (value, key) {\n\t\t\t\t\t_fileIdList.push({ fileId: value });\n\t\t\t\t});\n\t\t\t\tvar data = {\n\t\t\t\t\tfileIdList: _fileIdList\n\t\t\t\t};\n\t\t\t\t(0, _api.deleteWareFile)(data).then(function (res) {\n\t\t\t\t\tif (res.data.code === '0001') {\n\t\t\t\t\t\t_this5.$message.success(res.data.message);\n\t\t\t\t\t\t_this5.getWareFileList();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_this5.$message.error(res.data.message);\n\t\t\t\t\t}\n\t\t\t\t}).catch(function (error) {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\t_this5.catchError(error.response);\n\t\t\t\t});\n\t\t\t}).catch(function (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t\t_this5.$message('已取消操作');\n\t\t\t});\n\t\t},\n\t\thandleSetMainImg: function handleSetMainImg(row) {\n\t\t\tvar _this6 = this;\n\n\t\t\tif (row.status === 0) {\n\t\t\t\tthis.$notify({\n\t\t\t\t\ttype: 'warning',\n\t\t\t\t\ttitle: '提示',\n\t\t\t\t\tmessage: '请把该图片设为显示状态'\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar data = {\n\t\t\t\twareId: this.wareId,\n\t\t\t\tfileId: row.fileId,\n\t\t\t\tisMainPic: 1\n\t\t\t};\n\t\t\t(0, _api.updateWareFileIsMainPic)(data).then(function (res) {\n\t\t\t\tif (res.data.code === '0001') {\n\t\t\t\t\t_this6.$message.success(res.data.message);\n\t\t\t\t\t_this6.getWareFileList();\n\t\t\t\t} else {\n\t\t\t\t\t_this6.$message.error(res.data.message);\n\t\t\t\t}\n\t\t\t}).catch(function (error) {\n\t\t\t\t_this6.catchError(error.response);\n\t\t\t});\n\t\t},\n\t\thandleNext: function handleNext() {\n\t\t\tthis.$router.push('charge?wareId=' + this.wareId);\n\t\t}\n\t},\n\tcomputed: {\n\t\tmediaLength: function mediaLength() {\n\t\t\treturn this.maxLength - this.mediaList.length - this.fileList.length;\n\t\t}\n\t},\n\tmounted: function mounted() {\n\t\tthis.$store.dispatch('setStepActive', 2);\n\t\tthis.wareId = parseInt(this.$route.query.wareId);\n\t\tthis.wareId && this.getWareFileList();\n\t}\n};\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/51.990cb9b153a3cc1d12a0.js","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('section', [_c('el-row', {\n    staticClass: \"toolbar\"\n  }, [_c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.uploadVisible = true\n      }\n    }\n  }, [_vm._v(\"本地上传\")]), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"danger\",\n      \"disabled\": this.sels.length === 0\n    },\n    on: {\n      \"click\": _vm.batchRemove\n    }\n  }, [_vm._v(\"批量删除\")])], 1), _vm._v(\" \"), _c('el-table', {\n    directives: [{\n      name: \"loading\",\n      rawName: \"v-loading\",\n      value: (_vm.loading),\n      expression: \"loading\"\n    }],\n    staticStyle: {\n      \"width\": \"100%\"\n    },\n    attrs: {\n      \"border\": \"\",\n      \"data\": _vm.mediaList,\n      \"highlight-current-row\": \"\"\n    },\n    on: {\n      \"selection-change\": _vm.selsChange\n    }\n  }, [_c('el-table-column', {\n    attrs: {\n      \"type\": \"selection\",\n      \"width\": \"55\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"type\": \"index\",\n      \"width\": \"60\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"图片缩略图\",\n      \"width\": \"140\"\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(scope) {\n        return [_c('img', {\n          staticClass: \"cell-img\",\n          attrs: {\n            \"src\": scope.row.filePath,\n            \"height\": \"60px\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.viewImage(scope.row.filePath)\n            }\n          }\n        })]\n      }\n    }])\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"更新者\",\n      \"prop\": \"createName\",\n      \"width\": \"100\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"更新时间\",\n      \"prop\": \"createTime\",\n      \"formatter\": _vm.formatCreateTime,\n      \"sortable\": \"\"\n    }\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"是否显示\",\n      \"width\": \"120\"\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(scope) {\n        return [_c('el-switch', {\n          attrs: {\n            \"on-color\": \"#13ce66\",\n            \"off-color\": \"#ff4949\",\n            \"on-text\": \"是\",\n            \"off-text\": \"否\",\n            \"on-value\": 1,\n            \"off-value\": 0,\n            \"disabled\": scope.row.isMainPic === 1\n          },\n          on: {\n            \"change\": function($event) {\n              _vm.handleStatus(scope.row)\n            }\n          },\n          model: {\n            value: (scope.row.status),\n            callback: function($$v) {\n              scope.row.status = $$v\n            },\n            expression: \"scope.row.status\"\n          }\n        })]\n      }\n    }])\n  }), _vm._v(\" \"), _c('el-table-column', {\n    attrs: {\n      \"label\": \"操作\",\n      \"width\": \"180\"\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(scope) {\n        return [(scope.row.isMainPic === 0) ? _c('div', [_c('el-button', {\n          attrs: {\n            \"size\": \"small\",\n            \"type\": \"primary\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.handleSetMainImg(scope.row)\n            }\n          }\n        }, [_vm._v(\"设为主图\")]), _vm._v(\" \"), _c('el-button', {\n          attrs: {\n            \"size\": \"small\",\n            \"type\": \"danger\"\n          },\n          on: {\n            \"click\": function($event) {\n              _vm.handleSingleDelete(scope.row)\n            }\n          }\n        }, [_vm._v(\"删除\")])], 1) : _c('div', [_c('el-button', {\n          attrs: {\n            \"size\": \"small\",\n            \"type\": \"success\"\n          },\n          on: {\n            \"click\": function($event) {\n              return false\n            }\n          }\n        }, [_vm._v(\"当前主图\")])], 1)]\n      }\n    }])\n  })], 1), _vm._v(\" \"), _c('el-row', {\n    staticClass: \"text-center m-t\"\n  }, [_c('el-button', {\n    attrs: {\n      \"size\": \"large\",\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": _vm.handleNext\n    }\n  }, [_vm._v(\"下一步\")])], 1), _vm._v(\" \"), _c('el-dialog', {\n    attrs: {\n      \"title\": \"本地上传\",\n      \"visible\": _vm.uploadVisible,\n      \"size\": \"small\"\n    },\n    on: {\n      \"update:visible\": function($event) {\n        _vm.uploadVisible = $event\n      }\n    }\n  }, [_c('el-row', [_c('el-col', {\n    class: {\n      'text-danger': _vm.mediaLength === 0\n    },\n    attrs: {\n      \"span\": 20\n    }\n  }, [_vm._v(\"\\n\\t\\t\\t\\t\\t建议上传大小为1024*512图片，单张不超过2M，最多上传\" + _vm._s(_vm.maxLength) + \"张，还可以上传\" + _vm._s(_vm.mediaLength) + \"张。\\n\\t\\t\\t\\t\")])], 1), _vm._v(\" \"), _c('el-row', {\n    staticClass: \"m-t\"\n  }, [_c('el-col', {\n    attrs: {\n      \"span\": 20\n    }\n  }, [_c('el-upload', {\n    ref: \"uploadMedia\",\n    staticClass: \"multiple-uploader\",\n    attrs: {\n      \"name\": \"fileName\",\n      \"data\": _vm.uploadData,\n      \"action\": \"https://jsonplaceholder.typicode.com/posts/\",\n      \"list-type\": \"picture-card\",\n      \"accept\": \"image/jpeg, image/png\",\n      \"on-preview\": _vm.handleImgPreview,\n      \"on-remove\": _vm.handleRemove,\n      \"before-upload\": _vm.beforeUpload,\n      \"on-success\": _vm.handleSuccess,\n      \"on-error\": _vm.handleError,\n      \"multiple\": true,\n      \"disabled\": _vm.mediaLength === 0\n    }\n  }, [_c('i', {\n    staticClass: \"el-icon-plus\"\n  })])], 1)], 1), _vm._v(\" \"), _c('div', {\n    slot: \"footer\"\n  }, [_c('el-button', {\n    on: {\n      \"click\": function($event) {\n        _vm.uploadVisible = false\n      }\n    }\n  }, [_vm._v(\"取 消\")]), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": _vm.onSubmit\n    }\n  }, [_vm._v(\"确 定\")])], 1)], 1), _vm._v(\" \"), _c('el-dialog', {\n    attrs: {\n      \"size\": \"tiny\"\n    },\n    model: {\n      value: (_vm.previewVisible),\n      callback: function($$v) {\n        _vm.previewVisible = $$v\n      },\n      expression: \"previewVisible\"\n    }\n  }, [_c('img', {\n    attrs: {\n      \"width\": \"100%\",\n      \"src\": _vm.previewImgUrl\n    }\n  })])], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-5a95963d\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/pages/provider/ware/wareInput/multimedia.vue\n// module id = 1007\n// module chunks = 51","var Component = require(\"!../../../../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./multimedia.vue\"),\n  /* template */\n  require(\"!!../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5a95963d\\\"}!../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./multimedia.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/provider/ware/wareInput/multimedia.vue\n// module id = 791\n// module chunks = 51","<template>\r\n\t<section>\r\n\t  <!--  工具栏  -->\r\n\t\t<el-row class=\"toolbar\">\r\n\t\t\t<el-button type=\"primary\" @click=\"uploadVisible = true\">本地上传</el-button>\r\n\t\t\t<el-button type=\"danger\"  @click=\"batchRemove\" :disabled=\"this.sels.length===0\">批量删除</el-button>\r\n\t\t</el-row>\r\n\t\t<!-- 图片列表 -->\r\n\t\t<el-table \r\n\t\t\tborder\r\n\t\t\t:data=\"mediaList\"\r\n\t\t\tv-loading=\"loading\"\r\n\t\t\thighlight-current-row\r\n\t\t\tstyle=\"width: 100%\" \r\n\t\t\t@selection-change=\"selsChange\"> \r\n\t    <el-table-column type=\"selection\" width=\"55\"></el-table-column>\r\n\t    <el-table-column type=\"index\" width=\"60\"></el-table-column>\r\n\t    <el-table-column label=\"图片缩略图\" width=\"140\">\r\n\t    \t<template scope=\"scope\">\r\n\t\t    \t<img :src=\"scope.row.filePath\" height=\"60px\" class=\"cell-img\" @click=\"viewImage(scope.row.filePath)\">\r\n\t    \t</template>\r\n\t    </el-table-column>\r\n\t    <el-table-column label=\"更新者\" prop=\"createName\" width=\"100\"></el-table-column>\r\n\t    <el-table-column label=\"更新时间\" prop=\"createTime\" :formatter=\"formatCreateTime\" sortable></el-table-column>\r\n\t    <!-- <el-table-column label=\"是否为主图\" prop=\"isMainPic\" width=\"120\" :formatter=\"formatIsMainPic\"></el-table-column> -->\r\n\t    <el-table-column label=\"是否显示\" width=\"120\">\r\n\t    \t<template scope=\"scope\">\r\n\t    \t\t<el-switch\r\n\t\t\t\t\t  v-model=\"scope.row.status\"\r\n\t\t\t\t\t  on-color=\"#13ce66\"\r\n\t\t\t\t\t  off-color=\"#ff4949\"\r\n\t\t\t\t\t  on-text=\"是\"\r\n\t\t\t\t\t  off-text=\"否\"\r\n\t\t\t\t\t  :on-value=\"1\"\r\n\t\t\t\t\t  :off-value=\"0\"\r\n\t\t\t\t\t  :disabled=\"scope.row.isMainPic === 1\"\r\n\t\t\t\t\t  @change=\"handleStatus(scope.row)\">\r\n\t\t\t\t\t</el-switch>\r\n\t    \t</template>\r\n\t    </el-table-column>\r\n\t\t  <el-table-column label=\"操作\" width=\"180\">\r\n\t        <template scope=\"scope\">\r\n\t        \t<div v-if=\"scope.row.isMainPic === 0\">\r\n\t        \t\t<el-button size=\"small\" type=\"primary\" @click=\"handleSetMainImg(scope.row)\">设为主图</el-button>\r\n\t        \t\t<el-button size=\"small\" type=\"danger\" @click=\"handleSingleDelete(scope.row)\">删除</el-button>\r\n\t        \t</div>\r\n\t        \t<div v-else>\r\n\t\t        \t<el-button size=\"small\" type=\"success\" @click=\"return false\">当前主图</el-button>\r\n\t\t        </div>\r\n\t        </template>\r\n    \t</el-table-column>\r\n\t\t</el-table>\r\n\t\t<el-row class=\"text-center m-t\">\r\n\t\t\t<el-button size=\"large\" type=\"primary\" @click=\"handleNext\">下一步</el-button>\r\n\t\t</el-row>\r\n\t\t<!-- 本地上传 -->\r\n\t\t<el-dialog title=\"本地上传\" :visible.sync=\"uploadVisible\" size=\"small\">\r\n\t\t\t<el-row>\r\n\t\t\t\t<el-col :span=\"20\" :class=\"{ 'text-danger' : mediaLength === 0 }\">\r\n\t\t\t\t\t建议上传大小为1024*512图片，单张不超过2M，最多上传{{maxLength}}张，还可以上传{{mediaLength}}张。\r\n\t\t\t\t</el-col>\r\n\t\t\t</el-row>\r\n\t\t\t<el-row class=\"m-t\">\r\n\t\t\t\t<el-col :span=\"20\">\t\r\n\t\t\t\t\t<el-upload\r\n\t\t\t\t\t\tname=\"fileName\"\r\n\t\t\t\t\t\t:data=\"uploadData\"\r\n\t\t\t\t\t\tref=\"uploadMedia\"\r\n\t\t\t\t\t\tclass=\"multiple-uploader\"\r\n\t\t\t  \t\taction=\"https://jsonplaceholder.typicode.com/posts/\"\r\n\t\t\t  \t\tlist-type=\"picture-card\"\r\n\t\t\t  \t\taccept=\"image/jpeg, image/png\"\r\n\t\t\t  \t\t:on-preview=\"handleImgPreview\"\r\n\t\t\t  \t\t:on-remove=\"handleRemove\"\r\n\t\t\t  \t\t:before-upload=\"beforeUpload\"\r\n\t\t\t  \t\t:on-success=\"handleSuccess\"\r\n\t\t\t  \t\t:on-error=\"handleError\"\r\n\t\t\t  \t\t:multiple=\"true\"\r\n\t\t\t  \t\t:disabled=\"mediaLength === 0\">\r\n\t\t\t  \t\t<i class=\"el-icon-plus\"></i>\r\n\t\t\t\t\t</el-upload>\r\n\t\t\t\t</el-col>\r\n\t\t\t</el-row>\r\n\t\t  \t<div slot=\"footer\">\r\n\t\t\t    <el-button @click=\"uploadVisible = false\">取 消</el-button>\r\n\t\t\t    <el-button type=\"primary\" @click=\"onSubmit\">确 定</el-button>\r\n\t  \t\t</div>  \t\t\r\n\t\t</el-dialog>\r\n\t\t<!-- 图片预览 -->\r\n\t\t<el-dialog v-model=\"previewVisible\" size=\"tiny\">\r\n\t\t\t<img width=\"100%\" :src=\"previewImgUrl\">\r\n\t\t</el-dialog>\r\n\t</section>\r\n</template>\r\n<script>\r\n\timport { readWareFileList, createWareFile, updatetWareFileState, updateWareFileIsMainPic, deleteWareFile } from '@/api'\r\n\texport default{\r\n\t\tdata () {\r\n\t\t\treturn {\r\n\t\t\t\twareId: '',\r\n\t\t\t\tmaxLength: 10,\r\n    \t\tpreviewImgUrl: '',\r\n\t\t\t\tuploadVisible: false,\r\n    \t\tpreviewVisible: false,\r\n    \t\tfileList: [],\r\n\t\t\t\tmediaList: [{\r\n\t\t\t\t\tfileId: 100001,\r\n\t\t\t\t\tisMainPic: 1,\r\n\t\t\t\t\tstatus: 1,\r\n\t\t\t\t},{\r\n\t\t\t\t\tfileId: 100002,\r\n\t\t\t\t\tisMainPic: 0,\r\n\t\t\t\t\tstatus: 0,\r\n\t\t\t\t}],\r\n    \t\tfileIdList: [],\r\n    \t\tsels: [],\r\n    \t\tuploadData: {\r\n\t        fileUrlType: 1\r\n\t      },\r\n\t      loading: false,\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tformatIsMainPic (row, column) {\r\n\t\t\t\treturn row.isMainPic === 1 ? '是' : '否'\r\n\t\t\t},\r\n\t\t\tformatCreateTime (row, column) {\r\n\t\t\t\treturn this.$moment(row.createTime).format('YYYY-MM-DD HH:mm:ss')\r\n\t\t\t},\r\n\t\t\t// 获取图片列表\r\n\t\t\tgetWareFileList () {\r\n\t\t\t\tthis.loading = true;\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\twareId: this.wareId\r\n\t\t\t\t}\r\n\t\t\t\treadWareFileList(params).then(res => {\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tif (res.data.code === '0001') {\r\n\t\t\t\t\t\tthis.mediaList = res.data.result.fileList;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message.error(res.data.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\tthis.catchError(error.response)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 上传校验\r\n      beforeUpload (file) {\r\n        const isJPG = file.type === 'image/jpeg' || file.type === 'image/png';\r\n        const isLt2M = file.size / 1024 / 1024 < 2;\r\n        if (!isJPG) {\r\n          this.$message.error('图片只能是 JPG 或 PNG格式!');\r\n        }\r\n        if (!isLt2M) {\r\n          this.$message.error('图片大小不能超过 2MB!');\r\n        }\r\n        return isJPG && isLt2M;\r\n\t    },\r\n    \t// 上传成功处理\r\n    \thandleSuccess (res, file) {\r\n    \t\tthis.fileList.push(file.url)\r\n    \t\tif (res.code === '0001') {\r\n    \t\t\tlet resFile = res.result.file;\r\n\t\t\t    file.path = resFile.filePath;\r\n\t    \t\tthis.fileList.push(resFile)\r\n    \t\t} else {\r\n    \t\t\tthis.$message.error(res.message)\r\n    \t\t}\r\n    \t},\r\n    \t// 上传失败处理\r\n    \thandleError (err, file) {\r\n    \t\tconsole.log(file)\r\n    \t\tthis.$message.error('图片上传失败，请重试')\r\n    \t},\r\n    \t// 上传图片删除\r\n\t\t\thandleRemove (file) {\r\n        if (!file) return;\r\n        let fileList = this.fileList;\r\n        let filePath = file.path || '';\r\n        fileList = fileList.filter(file => file.filePath !== filePath)\r\n        this.fileList = fileList\r\n  \t\t},\r\n\t\t\t// 图片预览\r\n\t\t\thandleImgPreview (file, fileList) {\r\n\t\t\t\tthis.previewImgUrl = file.url;\r\n        this.previewVisible = true;\r\n    \t},\r\n \t    // 图片列表提交\r\n\t    onSubmit () {\r\n\t    \tlet mediaForm = {\r\n\t    \t\twareId: this.wareId,\r\n\t    \t\tfileList: this.fileList\r\n\t    \t}\r\n\t    \tconsole.log(mediaForm)\r\n\t    \tcreateWareFile(mediaForm).then(res => {\r\n\t    \t\tif(res.data.code === '0001') {\r\n\t    \t\t\tthis.$message.success('上传成功')\r\n\t    \t\t\tthis.getWareFileList()\r\n\t    \t\t} else {\r\n\t    \t\t\tthis.$message.error(res.data.message)\r\n\t    \t\t}\r\n\t    \t\tthis.uploadVisible = false\r\n\t    \t\tthis.fileList = []\r\n\t    \t\tthis.$refs.uploadMedia.clearFiles()\r\n\t    \t})\r\n\t    \t.catch(error => {\r\n\t    \t\tthis.catchError(error.response)\r\n\t    \t\tthis.uploadVisible = false\r\n\t    \t\tthis.fileList = []\r\n\t    \t\tthis.$refs.uploadMedia.clearFiles()\r\n\t    \t})\r\n\t    },\r\n\t    // 图片选中\r\n\t\t\tselsChange (sels) {\r\n\t\t\t\tthis.sels = sels;\r\n\t\t\t},\r\n\t\t\t// 图片查看\r\n\t\t\tviewImage (filePath) {\r\n\t\t\t\tthis.previewImgUrl = filePath;\r\n        this.previewVisible = true;\r\n\t\t\t},\r\n\t\t\t// 是否显示\r\n\t\t\thandleStatus (row) {\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\tfileId: row.fileId\r\n\t\t\t\t}\r\n\t\t\t\tupdatetWareFileState(data).then(res => {\r\n\t\t\t\t\tif (res.data.code === '0001') {\r\n\t\t\t\t\t\tthis.$message.success(res.data.message)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trow.status = row.status === 1 ? 0 : 1\r\n\t\t\t\t\t\tthis.$message.error(res.data.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(error => {\r\n\t\t\t\t\trow.status = row.status === 1 ? 0 : 1\r\n\t\t\t\t\tthis.catchError(error.response)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 单张图片删除\r\n\t\t\thandleSingleDelete (row) {\r\n\t\t\t\tlet _fileIdList = [];\r\n\t\t\t\t_fileIdList[0] = { fileId: row.fileId }\r\n\t\t\t\tthis.$confirm('确认删除该图片？', '提示', {type: 'warning'})\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tlet data = {\r\n\t\t\t\t\t\tfileIdList: _fileIdList\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdeleteWareFile(data).then(res => {\r\n\t\t\t\t\t\tif (res.data.code === '0001') {\r\n\t\t\t\t\t\t\tthis.$message.success(res.data.message)\r\n\t\t\t\t\t\t\tthis.getWareFileList()\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$message.error(res.data.message)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).catch(error => {\r\n\t\t\t\t\t\tthis.catchError(error.response)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t.catch((err) => {\r\n\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\tthis.$message('已取消操作')\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 批量删除\r\n\t\t\tbatchRemove () { \t\t\t\t\r\n\t\t\t\tthis.$confirm('确认删除选中的图片吗？', '提示', {type: 'warning'})\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tlet fileIds = this.sels.map(sel => sel.fileId);\r\n\t\t\t\t\tlet _fileIdList = [];\r\n\t\t\t\t\tfileIds.forEach((value, key) => {\r\n\t\t\t\t\t\t_fileIdList.push({ fileId: value })\r\n\t\t\t\t\t})\r\n\t\t\t\t\tlet data = {\r\n\t\t\t\t\t\tfileIdList: _fileIdList\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdeleteWareFile(data).then(res => {\r\n\t\t\t\t\t\tif(res.data.code === '0001') {\r\n\t\t\t\t\t\t\tthis.$message.success(res.data.message)\r\n\t\t\t\t\t\t\tthis.getWareFileList()\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$message.error(res.data.message)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\t\tconsole.log(error)\r\n\t\t\t\t\t\tthis.catchError(error.response)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t.catch((err) => {\r\n\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\tthis.$message('已取消操作')\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 设为主图\r\n\t\t\thandleSetMainImg (row) {\r\n\t\t\t\tif (row.status === 0) {\r\n\t\t\t\t\tthis.$notify({\r\n\t\t\t\t\t\ttype: 'warning',\r\n\t\t\t\t\t\ttitle: '提示',\r\n\t\t\t\t\t\tmessage: '请把该图片设为显示状态'\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\t\r\n\t\t\t\tlet data = {\r\n\t\t\t\t\twareId: this.wareId,\r\n\t\t\t\t\tfileId: row.fileId,\r\n\t\t\t\t\tisMainPic: 1,\r\n\t\t\t\t}\t\r\n\t\t\t\tupdateWareFileIsMainPic(data).then(res => {\r\n\t\t\t\t\tif(res.data.code === '0001') {\r\n\t\t\t\t\t\tthis.$message.success(res.data.message)\r\n\t\t\t\t\t\tthis.getWareFileList()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message.error(res.data.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tthis.catchError(error.response)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 下一步\r\n\t\t\thandleNext () {\r\n\t\t\t\tthis.$router.push(`charge?wareId=${this.wareId}`)\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed:{\r\n\t\t\tmediaLength () {\r\n\t\t\t\treturn  this.maxLength - this.mediaList.length - this.fileList.length;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted () {\r\n\t\t\tthis.$store.dispatch('setStepActive', 2)\r\n\t\t\tthis.wareId = parseInt(this.$route.query.wareId);\r\n\t\t\tthis.wareId && this.getWareFileList()\r\n\t\t}\r\n\t}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// multimedia.vue?51976672"],"sourceRoot":""}